<!DOCTYPE html>
<html lang="en" xmlns:jad="https://jadaptive.com/jadaptive">
<body>
<div class="wrapper">
<header jad:id="header"></header>
<main class="container my-auto">
   <div id="uploadForm" class="row justify-content-center">
         <div class="col-10">
            <div class="card">
         	   	<div class="card-header"><i class="far fa-upload"></i>&nbsp;<span id="uploadArea"></span> <span jad:bundle="default" jad:i18n="upload.name"></span></div>
       			<div class="card-body">		
      	<div class="col-12" id="feedback">
      	
      	</div>
	    <div class="row mb-3"> 
	    	<div class="col-12">
	    		<label for="name" class="form-label" jad:bundle="virtualFolder" jad:i18n="user.name">Name</label> 
         		 <input id="name" name="name" class="form-control" value="" type="text" required="true"> 
         		 <small class="form-text text-muted" jad:bundle="virtualFolder" jad:i18n="user.desc"></small> 
	    	</div>
         </div>	
         
	    <div class="row mb-3"> 
	        <div class="col-12">
	         	<label for="email" class="form-label" jad:bundle="virtualFolder" jad:i18n="email.name">Email</label> 
	         	 <input id="email" name="email" class="form-control" value="" type="text" required="true"> 
	         	 <small class="form-text text-muted" jad:bundle="virtualFolder" jad:i18n="email.desc"></small> 
	        </div>
	    </div>
        <div class="row mb-3"> 
	        <div class="col-12">
	         	<label for="reference" class="form-label" jad:bundle="virtualFolder" jad:i18n="reference.name">Email</label> 
	         	 <input id="reference" name="reference" class="form-control" value="" type="text" required="true"> 
	         	 <small class="form-text text-muted" jad:bundle="virtualFolder" jad:i18n="reference.desc"></small> 
	        </div>
         </div>
		<div class="row"> 
 	   		<div id="uploadHolder" jad:id="uploadWidget" class="col-12 mb-3"></div>

		</div>
      </div>
    </div>
   </div>
   </div>
</main>
</div>
<footer jad:id="footer"></footer>
<script type="text/javascript">

	const validateEmail = (email) => {
	  return email.match(
	    /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/
	  );
	};
	
	$(function() {
		UploadWidget.init('/upload/public/${page.shortCode}', '/app/ui/upload-complete/${page.shortCode}', "#feedback", function(fd) {
			
			var name = $('#name').val().trim();
			var email = $('#email').val().trim();
			var reference = $('#reference').val().trim();
			
			fd.append("name", name);
			fd.append("email", email);
			fd.append("reference", reference);
		}, function() {
			
			var name = $('#name').val();
			var email = $('#email').val();
			var reference = $('#reference').val();
			
			if(name.trim() === '' || email.trim() === '' || reference.trim() === '' || !validateEmail(email.trim())) {
				$('#feedback').append('<p class="alert alert-danger"><i class="far fa-exclamation-circle"></i> Please provide your name, valid email address and a reference for your files.</p>');
				return false;
			}

			return true;
		});
	});
</script>
</body>
</html>